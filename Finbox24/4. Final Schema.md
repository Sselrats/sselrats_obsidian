
## 1. 데이터베이스 전체 테이블 목록

### 1.1 어드민 사용자 (상담사)
- `consultants` - 상담사 : 로그인 세션은 jwt로 관리 
	- id
	- name
	- email
	- phone
	- status
	- register_number
	- affiliation
	- subscription
	- is_super

### 1.2 고객
- `customers` - 고객 기본 정보
	- id
	- name
	- birth_date
	- phone
	- email (UNIQUE, nullable)
	- password (hashed)
	- profile_image_url (카카오 프로필 이미지)
	- login_type (ENUM: phone, kakao, naver, google, apple)

- `sessions` - 고객 로그인 (정확히는 본인인증) 세션 (jwt 대신 세션 : 로그인 기기 저장)
	- id (PK)
	- customer_id (FK)
	- session_token (UNIQUE, 256bit hash)
	- login_method (ENUM: phone, kakao)
	- social_account_id (FK -> social_accounts, nullable)
	- device_info (JSON: user_agent, ip, device_id)
	- created_at
	- expires_at
	- last_accessed_at
	- is_active
	
- social_accounts (카카오만 하지만 추후 확장 대비)
	- id (PK)
	- customer_id (FK -> customers)
	- provider (ENUM: kakao, naver, google, apple) (소셜 제공자)
	- provider_id (VARCHAR(255), 카카오에서 제공하는 고유 ID)
	- access_token (TEXT, nullable) (API 호출용 토큰)
	- refresh_token (TEXT, nullable) (토큰 갱신용)
	- token_expires_at (액세스 토큰 만료시간)
	- kakao_profile_data (JSON) (카카오에서 받은 전체 프로필 데이터)
	- is_primary (BOOLEAN, default false) (주 로그인 수단 여부)
	- connected_at (최초 연결 시각)
	- last_login_at (마지막 로그인 시각)
	
- `customer_details` - 고객 상세 정보, 1개의 customer id 에 대해 누적 되도록, display 에는 최신 정보 사용 (most recent)
	- id (PK)
	- customer_id 
	- income_type (ENUM: 직장인, 사업자, 겸업) 
	- annual_income 
	- employment_insurance (4대보험 여부) 
	- kcb_score
	- nice_score 
	- business_number (사업자번호) 
	- business_start_date 
	- owned_properties_count 
	- required_amount (필요금액)

- `tmp_customer_details` - 임시 고객 상세 정보
	- id (PK)
	- session_id (VARCHAR(255), UNIQUE, NOT NULL) (localStorage)
	- ip_address (VARCHAR(45))
	- user_agent (TEXT)
	
	- income_type (ENUM: 직장인, 사업자, 겸업) 
	- annual_income 
	- employment_insurance (4대보험 여부) 
	- kcb_score
	- nice_score 
	- business_number (사업자번호) 
	- business_start_date 
	- owned_properties_count 
	- required_amount (필요금액)
	
	- converted_customer_id (FK -> customers, nullable) -- 회원가입 시 연결
	- is_converted (BOOLEAN, DEFAULT false) -- 회원가입 완료 여부
	- converted_at (TIMESTAMP, nullable) -- 회원가입 시각
	
### 1.3 상담 물건, 기존 대출
- `properties` - 담보 물건 정보
	- id
	- customer_id
	- address_full
	- sido (시도) 
	- sigungu (시군구) 
	- dong 
	- detail_address 
	- property_type (아파트 등)
	- exclusive_area (전용면적) 
	- households (세대수) 
	- building_age (년차) 
	- kb_lower_price 
	- kb_standard_price 
	- kb_upper_price 
	- latest_transaction_price (최근실거래가)
- `existing_mortgages` - 기존 대출 정보
	-  id (PK)
	- property_id (FK)
	- creditor (채권자)
	- mortgage_amount (설정액)
	- remaining_balance (잔액)
	- mortgage_type (ENUM: 가계, 사업자)
	- registration_date (대출일)
	- maturity_date (만기일)

### 1.4 금융 상품 및 정책
- `financial_institutions` - 금융기관
	- id (PK)
	- name (예: 현캐, 지방은행)
	- type (ENUM: 캐피탈, 저축은행, 보험사, 은행)
	- is_active
	
- `financial_products` - 금융 상품
	- id (PK)
	- institution_id (FK)
	- product_name (예: 현캐 가계대출)
	- loan_type (ENUM: 가계, 사업자, 조합)
	- priority_type (ENUM: 선순위, 후순위)
	- is_active

- interest_rate_policies - 금리 정책
	- id (PK)
	- financial_product_id (FK)
	- effective_date
	- expired_date
	- priority_type (선순위/후순위)
	- base_rate (기준금리 %)
	- rate_adjustment (가산금리 %)
	- special_conditions (JSON: 직장인/사업자 차등 등)

- `ltv_policies` - 상품별 정책 (LTV, DSR 등)
	- id (PK)
	- financial_product_id (FK)
	- effective_date
	- expired_date
	- priority_type
	- ltv_ratio (예: 70 -> 70%)
	- max_amount (최대한도, NULL이면 무제한)
	- conditions (JSON: 추가조건)
	
- region_grade_policies - 급지 정책
	- id (PK)
	- effective_date
	- expired_date
	- region_type (ENUM: 수도권, 광역시, 군읍, 전국)
	- detailed_regions (JSON: ["서울", "수원", "성남"...])
	- grade (등급: 1급지, 2급지 등)
	- description 
	- exclusions (JSON: 제외지역)

- collateral_requirements - 담보물 제약 조건
	- id (PK)
	- financial_product_id (FK)
	- effective_date
	- expired_date
	- property_type (ENUM: 아파트, 빌라, 단독, 오피스텔)
	- min_kb_value (KB시세 최소값)
	- min_households (최소 세대수)
	- max_building_age (최대 건축년수)
	- floor_restrictions (JSON: {"1층": "하한가", "2층": "일반가"})
	- region_restrictions (JSON: 지역제한)
	- special_conditions (TEXT: 기타 특이사항)
- credit_requirements - 신용 제한 조건
	- id (PK)
	- financial_product_id (FK)
	- effective_date
	- expired_date
	- min_nice_score
	- min_kcb_score
	- max_overdue_days (최대연체일수)
	- additional_conditions (JSON)
- prepayment_fee_policies - 중도 상환 수수료
	- id (PK)
	- financial_product_id (FK)
	- effective_date
	- expired_date
	- fee_type (ENUM: 고정, 슬라이딩)
	- year_fees (\[1.8, 1.6, 1.4\] (%))
	- calculation_method (JSON: 상세계산식)
- other_fees - 기타 수수료
	- id (PK)
	- financial_product_id (FK)
	- effective_date
	- expired_date
	- fee_name (예: 중개수수료, 인지대)
	- fee_rate (%)
	- min_amount
	- max_amount

-- 계산
- loan_calculations 
	- id (PK)
	- customer_id (FK)
	- property_id (FK)
	- calculation_date
	- policy_snapshot (JSON: 사용된 정책 버전들)
	- results (JSON: 전체 계산 결과)
- product_calculation_results - 상품별 산출 결과
	- id (PK)
	- calculation_id (FK)
	- financial_product_id (FK)
	- is_eligible (대출가능 여부)
	- priority_ltv (선순위 LTV)
	- priority_limit (선순위 한도)
	- priority_rate (선순위 금리)
	- secondary_ltv (후순위 LTV)
	- secondary_limit (후순위 한도)
	- secondary_rate (후순위 금리)
	- available_amount (가용금액)
	- rejection_reasons (JSON: 거절사유)
	- calculation_details (JSON: 상세계산과정)


### 1.5 상담, 업무 등
- `consultations` - 상담 건
	- id
	- customer_id
	- consultant_id
	- property_id
	- type (enum: 전화상담, 채팅상담)
	- status (ENUM: 상담대기, 상담중, 조회중, 심사중, 승인, 실행, 종료)
	- institution_id
	- institution_manager
- `consultation_memos` - 상담 메모
	- id
	- consultation_id
	- memo
- consultation_memo_attachments - 상담 메모 첨부파일
	- id
	- consultation_memo_id
	- attachment_id
- attachments - 첨부파일 구조 재사용
	- id (PK)
	- file_name
	- file_path
	- file_size
	- mime_type
	- uploaded_by (FK -> consultants)
	- uploaded_at


- `offers` - 고객별 대출 제안 결과

### 1.6 업무 관리
- `tasks` - 할일
	- id
	- consultation_id
	- consultant_id
	- customer_id
	- deadline
	- priority (enum: 높음, 보통, 낮음)
	- status (enum: 대기, 진행중, 완료)

- `inquiries` - 문의? 이메일?

### 1.7 시스템 
- `verification_codes` - 휴대폰 인증 코드
	- id (PK)
	- phone (인증 요청 전화번호)
	- code (6자리 인증코드, hashed)
	- purpose (ENUM: phone_signup, phone_login, phone_verify, password_reset)
	- is_verified
	- verified_at
	- expires_at (유효기간 5분?)
	- attempt_count (인증 시도 횟수)
	- ip_address

- `audit_logs` - 감사 로그
	- id (PK)
	- table_name
	- record_id
	- action (ENUM: INSERT, UPDATE, DELETE)
	- actor_type (ENUM: consultant, customer, system)
	- actor_id
	- changed_fields (JSON)
	- old_values (JSON)
	- new_values (JSON)
	- ip_address
	- user_agent
	- created_at
- `system_settings` - 시스템 설정

