
# 대출청진기 - 담보대출 상담 프로세스 플로우차트

## 1. 전체 프로세스 개요

담보대출 상담 프로세스는 크게 3개의 주요 단계로 구성됩니다:
1. **고객 접수 단계** (Customer Intake)
2. **대출 매칭 및 제안 단계** (Loan Matching & Offers)
3. **상담 및 실행 단계** (Consultation & Execution)

---

## 2. 상세 프로세스 플로우차트

### 2.1 전체 워크플로우 (High-Level)

```mermaid
flowchart TD
    Start([고객 방문]) --> Landing[대출청진기 랜딩 페이지]
    Landing --> ChatStart{대화 시작}
    
    ChatStart -->|대화로 상담 시작| Intake[정보 입력<br/>챗봇 인터페이스]
    ChatStart -->|전화 상담 신청| PhoneRequest[전화번호 입력]
    
    Intake --> IntakeComplete[정보 입력 완료]
    IntakeComplete --> PhoneVerify[휴대폰 본인 인증]
    PhoneVerify --> Matching[대출 매칭 알고리즘 실행]
    Matching --> ShowOffers[제안 결과 표시<br/>2-3개 금융사]
    
    ShowOffers --> RequestConsult{전문 상담 신청?}
    RequestConsult -->|예| ConsultRequest[상담 신청]
    RequestConsult -->|아니오| End1([종료])
    
    PhoneRequest --> ConsultRequest
    
    ConsultRequest --> AdminReview[관리자 검토]
    AdminReview --> AssignConsultant[상담사 배정]
    AssignConsultant --> CreateTask[할일 자동 생성]
    
    CreateTask --> ConsultantContact[상담사 고객 연락]
    ConsultantContact --> DetailedConsult[상세 상담 진행]
    DetailedConsult --> InquiryToBank[금융사 조회]
    InquiryToBank --> BankResponse[금융사 응답]
    BankResponse --> FinalProposal[최종 제안]
    
    FinalProposal --> CustomerDecision{고객 결정}
    CustomerDecision -->|승인| LoanApproval[대출 승인]
    CustomerDecision -->|거절| End2([종료])
    
    LoanApproval --> LoanExecution[대출 실행]
    LoanExecution --> End3([완료])
```

---

### 2.2 고객 접수 단계 (Customer Intake)

```mermaid
flowchart TD
    Start([고객 랜딩 페이지 방문]) --> ViewPage[페이지 내용 확인<br/>- 서비스 소개<br/>- 가치 제안<br/>- 이용 방법]
    
    ViewPage --> Action{고객 행동}
    
    Action -->|대화로 상담 시작| OpenChat[챗봇 인터페이스 오픈]
    Action -->|전화 상담 신청| PhoneForm[전화번호 입력 폼]
    Action -->|내 정보 확인| CheckHistory{최근 조회 내역?}
    
    CheckHistory -->|있음| ShowHistory[이전 조회 결과 표시]
    CheckHistory -->|없음| NoHistory[조회 내역 없음 안내]
    
    PhoneForm --> SubmitPhone[전화번호 제출]
    SubmitPhone --> CreateConsult1[상담 건 생성<br/>status: consultation_requested]
    CreateConsult1 --> NotifyAdmin1[관리자에게 알림]
    NotifyAdmin1 --> End1([대기])
    
    OpenChat --> ChatFlow[챗봇 대화 시작]
    
    ChatFlow --> Q1[질문 1: 직업 유형]
    Q1 --> A1[답변: employee/business/freelancer 등]
    
    A1 --> Q2[질문 2: 연 소득]
    Q2 --> A2[답변: 소득 구간 선택]
    
    A2 --> Q3[질문 3: 신용 등급]
    Q3 --> A3[답변: KCB/NICE 등급 구간]
    
    A3 --> Q4[질문 4: 담보 물건 유형]
    Q4 --> A4[답변: 아파트/상가/오피스텔 등]
    
    A4 --> Q5[질문 5: 물건 주소]
    Q5 --> A5[답변: 주소 입력<br/>주소 검색 API 활용]
    
    A5 --> Q6[질문 6: KB 시세]
    Q6 --> A6[답변: 시세 입력<br/>또는 자동 조회]
    
    A6 --> Q7[질문 7: 기존 대출]
    Q7 --> A7[답변: 은행명, 금액]
    
    A7 --> Q8[질문 8: 희망 대출 금액]
    Q8 --> A8[답변: 금액 입력]
    
    A8 --> Q9[질문 9: 대출 목적]
    Q9 --> A9[답변: 구입자금/유동성/전세반환 등]
    
    A9 --> IntakeComplete[정보 입력 완료]
    IntakeComplete --> SaveData[데이터 저장<br/>customers, properties,<br/>existing_loans, consultations]
    SaveData --> NextStep([휴대폰 인증 단계로])
```

---

### 2.3 대출 매칭 및 제안 단계 (Loan Matching)

```mermaid
flowchart TD
    Start([정보 입력 완료]) --> PhoneVerify[휴대폰 본인 인증 요청]
    
    PhoneVerify --> SendCode[인증 코드 발송<br/>Mock: 000000]
    SendCode --> EnterCode[고객이 코드 입력]
    EnterCode --> VerifyCode{코드 검증}
    
    VerifyCode -->|실패| RetryCode{재시도 가능?}
    RetryCode -->|예| SendCode
    RetryCode -->|아니오| VerifyFail([인증 실패])
    
    VerifyCode -->|성공| UpdateStatus1[상담 상태 업데이트<br/>status: phone_verified]
    UpdateStatus1 --> StartMatching[대출 매칭 시작]
    
    StartMatching --> LoadData[고객 데이터 로드<br/>- 직업, 소득, 신용<br/>- 담보 물건 정보<br/>- 희망 금액]
    
    LoadData --> CalcLTV[LTV 계산<br/>LTV = 희망금액 / 담보시세]
    CalcLTV --> CalcDSR[DSR 계산<br/>월상환액 / 월소득]
    
    CalcDSR --> LoadPolicies[금융사 정책 로드<br/>product_policies 테이블]
    
    LoadPolicies --> FilterPolicies[정책 필터링]
    
    FilterPolicies --> Check1{물건 유형 일치?}
    Check1 -->|아니오| Exclude1[제외]
    Check1 -->|예| Check2{지역 급지 일치?}
    
    Check2 -->|아니오| Exclude2[제외]
    Check2 -->|예| Check3{LTV <= 최대 LTV?}
    
    Check3 -->|아니오| Exclude3[제외]
    Check3 -->|예| Check4{DSR <= DSR 한도?}
    
    Check4 -->|아니오| Exclude4[제외]
    Check4 -->|예| Check5{신용등급 충족?}
    
    Check5 -->|아니오| Exclude5[제외]
    Check5 -->|예| Check6{직업 유형 허용?}
    
    Check6 -->|아니오| Exclude6[제외]
    Check6 -->|예| Check7{소득 >= 최소 소득?}
    
    Check7 -->|아니오| Exclude7[제외]
    Check7 -->|예| Include[매칭 성공]
    
    Include --> AddToList[제안 목록에 추가]
    
    AddToList --> MorePolicies{더 확인할 정책?}
    MorePolicies -->|예| FilterPolicies
    MorePolicies -->|아니오| SortOffers[제안 정렬<br/>금리 낮은 순]
    
    SortOffers --> SelectTop[상위 2-3개 선택]
    SelectTop --> SaveOffers[offers 테이블에 저장<br/>- 금융기관<br/>- 최대 한도<br/>- 금리 범위<br/>- LTV/DSR 적용값]
    
    SaveOffers --> UpdateStatus2[상담 상태 업데이트<br/>status: offers_generated]
    UpdateStatus2 --> DisplayOffers[고객에게 결과 표시]
    
    DisplayOffers --> ShowCard1[제안 1<br/>금융기관명<br/>최대 한도<br/>금리 범위]
    DisplayOffers --> ShowCard2[제안 2<br/>금융기관명<br/>최대 한도<br/>금리 범위]
    DisplayOffers --> ShowCard3[제안 3<br/>금융기관명<br/>최대 한도<br/>금리 범위]
    
    ShowCard1 --> Disclaimer[주의사항 표시<br/>예상 결과이며<br/>실제 심사 시 변동 가능]
    ShowCard2 --> Disclaimer
    ShowCard3 --> Disclaimer
    
    Disclaimer --> NextAction{고객 행동}
    NextAction -->|전문 상담 신청| RequestConsult([상담 신청 단계로])
    NextAction -->|결과 저장 후 종료| SaveAndExit([종료])
```

---

### 2.4 상담 및 실행 단계 (Consultation & Execution)

```mermaid
flowchart TD
    Start([고객이 전문 상담 신청]) --> UpdateStatus1[상담 상태 업데이트<br/>status: consultation_requested]
    
    UpdateStatus1 --> NotifyAdmin[관리자에게 알림<br/>신규 상담 건 발생]
    
    NotifyAdmin --> AdminLogin[관리자 Admin 페이지 로그인]
    AdminLogin --> ViewDashboard[대시보드 확인<br/>신규 상담 건 목록]
    
    ViewDashboard --> SelectConsult[상담 건 선택]
    SelectConsult --> ViewDetails[상세 정보 확인<br/>- 고객 정보<br/>- 담보 물건<br/>- 제안된 상품<br/>- 매칭 결과]
    
    ViewDetails --> AssignDecision{상담사 배정}
    
    AssignDecision --> SelectConsultant[상담사 선택<br/>- 지역별<br/>- 업무량별<br/>- 전문성별]
    
    SelectConsultant --> UpdateAssignment[상담 정보 업데이트<br/>consultant_id 설정<br/>status: assigned]
    
    UpdateAssignment --> CreateTask[할일 자동 생성<br/>- 제목: 고객명 상담<br/>- 담당자: 배정된 상담사<br/>- 마감일: D+1<br/>- 우선순위: high]
    
    CreateTask --> NotifyConsultant[상담사에게 알림<br/>새 할일 배정]
    
    NotifyConsultant --> ConsultantView[상담사 할일 확인<br/>고객수첩 또는 Admin]
    
    ConsultantView --> ContactCustomer[고객에게 연락<br/>전화 또는 문자]
    
    ContactCustomer --> UpdateStatus2[상담 상태 업데이트<br/>status: in_progress]
    
    UpdateStatus2 --> DetailedConsult[상세 상담 진행<br/>- 추가 정보 확인<br/>- 고객 니즈 파악<br/>- 서류 안내]
    
    DetailedConsult --> AddMemo1[상담 메모 작성<br/>consultation_memos]
    
    AddMemo1 --> NeedInquiry{금융사 조회 필요?}
    
    NeedInquiry -->|아니오| DirectProposal[기존 제안으로 진행]
    NeedInquiry -->|예| CreateInquiry[조회 요청 생성<br/>inquiry_requests]
    
    CreateInquiry --> SelectInstitutions[조회 대상 금융사 선택<br/>2-5개 금융사]
    SelectInstitutions --> SendInquiry[금융사에 조회 요청<br/>- 고객 정보<br/>- 담보 정보<br/>- 희망 금액]
    
    SendInquiry --> WaitResponse[금융사 응답 대기]
    WaitResponse --> ReceiveResponse[응답 수신<br/>inquiry_responses<br/>- 최대 한도<br/>- 금리]
    
    ReceiveResponse --> CompareOffers[제안 비교 분석]
    CompareOffers --> AddMemo2[상담 메모 추가<br/>조회 결과 정리]
    
    DirectProposal --> PrepareProposal[최종 제안서 준비]
    AddMemo2 --> PrepareProposal
    
    PrepareProposal --> PresentToCustomer[고객에게 제안<br/>- 추천 금융사<br/>- 예상 한도<br/>- 예상 금리<br/>- 필요 서류<br/>- 진행 절차]
    
    PresentToCustomer --> CustomerReview[고객 검토]
    CustomerReview --> CustomerDecision{고객 결정}
    
    CustomerDecision -->|진행| Approval[고객 승인]
    CustomerDecision -->|보류| Hold[보류 처리<br/>추가 상담 예약]
    CustomerDecision -->|거절| Reject[거절 처리<br/>status: closed]
    
    Hold --> AddMemo3[상담 메모 추가<br/>보류 사유]
    AddMemo3 --> FollowUp[후속 조치 할일 생성]
    FollowUp --> End1([대기])
    
    Reject --> AddMemo4[상담 메모 추가<br/>거절 사유]
    AddMemo4 --> CloseTask[할일 완료 처리]
    CloseTask --> End2([종료])
    
    Approval --> UpdateStatus3[상담 상태 업데이트<br/>status: approved]
    UpdateStatus3 --> PrepareDocuments[서류 준비 안내<br/>- 신분증<br/>- 등기부등본<br/>- 소득 증빙<br/>- 재직 증명]
    
    PrepareDocuments --> SubmitToBank[금융사 정식 신청]
    SubmitToBank --> BankReview[금융사 심사]
    BankReview --> BankDecision{금융사 승인?}
    
    BankDecision -->|거절| BankReject[금융사 거절<br/>다른 금융사 시도]
    BankDecision -->|승인| BankApproval[금융사 승인]
    
    BankReject --> AddMemo5[상담 메모 추가<br/>거절 사유]
    AddMemo5 --> TryOther{다른 금융사 시도?}
    TryOther -->|예| SendInquiry
    TryOther -->|아니오| FinalReject[최종 거절<br/>status: closed]
    FinalReject --> End3([종료])
    
    BankApproval --> UpdateStatus4[상담 상태 업데이트<br/>status: executed]
    UpdateStatus4 --> LoanExecution[대출 실행<br/>- 계약 체결<br/>- 자금 실행]
    
    LoanExecution --> AddMemo6[상담 메모 추가<br/>실행 완료]
    AddMemo6 --> CompleteTask[할일 완료 처리]
    CompleteTask --> UpdateCustomer[고객 상태 업데이트<br/>status: 실행]
    
    UpdateCustomer --> FollowUpService[사후 관리<br/>- 만족도 조사<br/>- 추가 니즈 확인]
    
    FollowUpService --> End4([완료])
```

---

### 2.5 관리자 워크플로우

```mermaid
flowchart TD
    Start([관리자 로그인]) --> Dashboard[대시보드 확인]
    
    Dashboard --> ViewMetrics[주요 지표 확인<br/>- 신규 상담 건수<br/>- 진행 중 상담<br/>- 승인/실행 건수<br/>- 상담사별 성과]
    
    ViewMetrics --> Action{관리 작업}
    
    Action -->|신규 상담 배정| NewConsult[신규 상담 목록<br/>status: consultation_requested]
    Action -->|진행 상황 모니터링| Monitor[전체 상담 목록<br/>필터링/정렬]
    Action -->|상담사 관리| ManageConsultant[상담사 목록<br/>추가/수정/비활성화]
    Action -->|금융사 정책 관리| ManagePolicy[정책 목록<br/>추가/수정/비활성화]
    Action -->|시스템 설정| Settings[시스템 설정<br/>알림/권한 등]
    
    NewConsult --> SelectNew[상담 건 선택]
    SelectNew --> ViewDetail1[상세 정보 확인]
    ViewDetail1 --> Assign[상담사 배정]
    Assign --> CreateTask1[할일 자동 생성]
    CreateTask1 --> Notify1[상담사 알림]
    Notify1 --> Dashboard
    
    Monitor --> FilterList[목록 필터링<br/>- 상태별<br/>- 상담사별<br/>- 기간별]
    FilterList --> SelectConsult[상담 건 선택]
    SelectConsult --> ViewDetail2[상세 정보 확인<br/>- 고객 정보<br/>- 진행 상황<br/>- 상담 메모<br/>- 제안 내역]
    ViewDetail2 --> AdminAction{관리 작업}
    
    AdminAction -->|상담사 변경| Reassign[상담사 재배정]
    AdminAction -->|상태 변경| ChangeStatus[상태 수동 변경]
    AdminAction -->|메모 추가| AddMemo[관리자 메모 추가]
    AdminAction -->|고객 정보 수정| EditCustomer[고객 정보 수정]
    
    Reassign --> AuditLog1[감사 로그 기록<br/>변경 사유]
    ChangeStatus --> AuditLog2[감사 로그 기록<br/>변경 사유]
    AddMemo --> Save1[저장]
    EditCustomer --> AuditLog3[감사 로그 기록<br/>변경 내역]
    
    AuditLog1 --> Dashboard
    AuditLog2 --> Dashboard
    Save1 --> Dashboard
    AuditLog3 --> Dashboard
    
    ManageConsultant --> ConsultantList[상담사 목록]
    ConsultantList --> ConsultantAction{작업}
    ConsultantAction -->|신규 등록| AddConsultant[상담사 추가<br/>- 이메일<br/>- 이름<br/>- 전화번호<br/>- 역할]
    ConsultantAction -->|정보 수정| EditConsultant[상담사 정보 수정]
    ConsultantAction -->|비활성화| DeactivateConsultant[상담사 비활성화]
    
    AddConsultant --> SaveConsultant[저장 및 알림]
    EditConsultant --> SaveConsultant
    DeactivateConsultant --> SaveConsultant
    SaveConsultant --> Dashboard
    
    ManagePolicy --> PolicyList[정책 목록<br/>금융사별/상품별]
    PolicyList --> PolicyAction{작업}
    PolicyAction -->|신규 등록| AddPolicy[정책 추가<br/>- 금융사<br/>- 상품<br/>- LTV/DSR<br/>- 금리 등]
    PolicyAction -->|정보 수정| EditPolicy[정책 수정]
    PolicyAction -->|비활성화| DeactivatePolicy[정책 비활성화]
    
    AddPolicy --> SavePolicy[저장 및 버전 관리]
    EditPolicy --> SavePolicy
    DeactivatePolicy --> SavePolicy
    SavePolicy --> Dashboard
    
    Settings --> SettingsList[설정 목록]
    SettingsList --> EditSettings[설정 수정]
    EditSettings --> SaveSettings[저장]
    SaveSettings --> Dashboard
```

---

### 2.6 상담사 워크플로우 (고객수첩)

```mermaid
flowchart TD
    Start([상담사 로그인]) --> Dashboard[대시보드 확인]
    
    Dashboard --> ViewTasks[오늘의 할일<br/>- 지연된 할일<br/>- 오늘 마감<br/>- 완료된 할일]
    
    ViewTasks --> Action{작업 선택}
    
    Action -->|할일 처리| TaskDetail[할일 상세]
    Action -->|고객 관리| CustomerList[내 고객 목록]
    Action -->|파이프라인| Pipeline[영업 파이프라인<br/>단계별 고객]
    Action -->|성과 확인| Performance[성과 대시보드<br/>- 상담 건수<br/>- 승인율<br/>- 실행 금액]
    
    TaskDetail --> ViewTaskInfo[할일 정보 확인<br/>- 고객명<br/>- 마감일<br/>- 우선순위]
    ViewTaskInfo --> LinkedCustomer{연관 고객?}
    
    LinkedCustomer -->|예| ViewCustomerInfo[고객 정보 확인]
    LinkedCustomer -->|아니오| ProcessTask[할일 처리]
    
    ViewCustomerInfo --> ProcessTask
    ProcessTask --> UpdateTaskStatus[할일 상태 변경<br/>todo → in_progress → done]
    UpdateTaskStatus --> Dashboard
    
    CustomerList --> FilterCustomer[고객 필터링<br/>- 상태별<br/>- 기간별]
    FilterCustomer --> SelectCustomer[고객 선택]
    SelectCustomer --> CustomerDetail[고객 상세 정보<br/>- 기본 정보<br/>- 담보 물건<br/>- 상담 이력<br/>- 제안 내역]
    
    CustomerDetail --> CustomerAction{작업}
    CustomerAction -->|상담 메모 추가| AddMemo1[메모 작성 및 저장]
    CustomerAction -->|상태 변경| ChangeStatus1[상태 변경]
    CustomerAction -->|금융사 조회| CreateInquiry1[조회 요청 생성]
    CustomerAction -->|제안서 작성| CreateProposal[제안서 작성]
    CustomerAction -->|할일 생성| CreateTask1[새 할일 생성]
    
    AddMemo1 --> Dashboard
    ChangeStatus1 --> Dashboard
    CreateInquiry1 --> Dashboard
    CreateProposal --> Dashboard
    CreateTask1 --> Dashboard
    
    Pipeline --> ViewStages[단계별 고객 확인<br/>- 상담 중<br/>- 조회 중<br/>- 심사 중<br/>- 승인<br/>- 실행]
    ViewStages --> DragDrop[드래그 앤 드롭으로<br/>단계 이동]
    DragDrop --> UpdateStage[고객 상태 업데이트]
    UpdateStage --> Dashboard
    
    Performance --> ViewMetrics[성과 지표 확인<br/>- 기간별 통계<br/>- 목표 대비 달성률<br/>- 금융사별 실적]
    ViewMetrics --> Dashboard
```

---

## 3. 상태 전이 다이어그램 (State Transition)

### 3.1 상담 상태 (consultations.status)

```mermaid
stateDiagram-v2
    [*] --> intake_started: 챗봇 시작
    intake_started --> intake_completed: 정보 입력 완료
    intake_completed --> phone_verified: 휴대폰 인증 성공
    phone_verified --> offers_generated: 매칭 알고리즘 실행
    offers_generated --> consultation_requested: 전문 상담 신청
    consultation_requested --> assigned: 상담사 배정
    assigned --> in_progress: 상담 시작
    in_progress --> approved: 고객 승인
    in_progress --> closed: 고객 거절
    approved --> executed: 대출 실행
    executed --> [*]: 완료
    closed --> [*]: 종료
    
    note right of intake_started
        고객이 챗봇으로
        정보 입력 시작
    end note
    
    note right of offers_generated
        2-3개 금융사
        제안 생성
    end note
    
    note right of assigned
        관리자가 상담사 배정
        할일 자동 생성
    end note
    
    note right of executed
        대출 실행 완료
        사후 관리 시작
    end note
```

### 3.2 고객 상태 (customers.status)

```mermaid
stateDiagram-v2
    [*] --> 등록: 고객 정보 생성
    등록 --> 상담중: 상담사 배정
    상담중 --> 조회중: 금융사 조회 시작
    조회중 --> 심사중: 금융사 정식 신청
    심사중 --> 승인: 금융사 승인
    심사중 --> 상담중: 금융사 거절 (재시도)
    승인 --> 실행: 대출 실행
    실행 --> 종료: 사후 관리 완료
    상담중 --> 종료: 고객 거절
    
    note right of 등록
        최초 상담 신청 시
    end note
    
    note right of 조회중
        2-5개 금융사에
        동시 조회
    end note
    
    note right of 실행
        계약 체결 및
        자금 실행
    end note
```

### 3.3 할일 상태 (tasks.status)

```mermaid
stateDiagram-v2
    [*] --> todo: 할일 생성
    todo --> in_progress: 작업 시작
    in_progress --> done: 작업 완료
    in_progress --> todo: 작업 보류
    done --> [*]: 완료
    
    note right of todo
        상담사 배정 시
        자동 생성
    end note
    
    note right of done
        완료 시각 기록
    end note
```

---

## 4. 시스템 간 상호작용 다이어그램

### 4.1 고객 - 백엔드 - 관리자 상호작용

```mermaid
sequenceDiagram
    participant C as 고객<br/>(대출청진기)
    participant B as 백엔드<br/>(FastAPI)
    participant A as 관리자<br/>(Admin)
    participant S as 상담사<br/>(고객수첩)
    
    C->>B: 1. 정보 입력 (챗봇)
    B->>B: 2. 데이터 저장 (customers, properties, consultations)
    C->>B: 3. 휴대폰 인증
    B->>B: 4. 인증 코드 검증
    B->>B: 5. 대출 매칭 알고리즘 실행
    B->>B: 6. 제안 생성 (offers)
    B->>C: 7. 제안 결과 반환
    C->>B: 8. 전문 상담 신청
    B->>A: 9. 신규 상담 알림
    A->>B: 10. 상담사 배정
    B->>B: 11. 할일 자동 생성 (tasks)
    B->>S: 12. 할일 알림
    S->>B: 13. 고객 정보 조회
    S->>C: 14. 고객 연락 (전화/문자)
    S->>B: 15. 상담 메모 작성
    S->>B: 16. 금융사 조회 요청
    B->>S: 17. 조회 결과 반환
    S->>C: 18. 최종 제안
    C->>S: 19. 승인
    S->>B: 20. 상태 업데이트 (approved → executed)
```

---

## 5. 주요 비즈니스 규칙

### 5.1 대출 매칭 규칙
1. **LTV (Loan to Value)**: 희망 금액 / 담보 시세
   - 은행: 최대 70%
   - 비은행: 최대 80%
   - 물건 유형 및 급지에 따라 차등

2. **DSR (Debt Service Ratio)**: 총 부채 원리금 상환액 / 연 소득
   - 은행: 최대 40%
   - 비은행: 최대 50%

3. **신용 등급**: 금융사별 최소 요구 등급
   - 은행: KCB 700+ 또는 NICE 700+
   - 비은행: KCB 600+ 또는 NICE 600+

4. **직업 유형**: 금융사별 허용 직업
   - 은행: 직장인, 사업자
   - 비은행: 직장인, 사업자, 프리랜서

5. **소득**: 금융사별 최소 소득
   - 은행: 연 2,400만원 이상
   - 비은행: 연 1,800만원 이상

### 5.2 상담 배정 규칙
1. **지역별 배정**: 담보 물건 지역과 상담사 담당 지역 매칭
2. **업무량 균등**: 진행 중인 상담 건수 고려
3. **전문성**: 물건 유형별 전문 상담사 우선 배정
4. **우선순위**: 고액 상담 건은 시니어 상담사 배정

### 5.3 할일 생성 규칙
1. **자동 생성**: 상담사 배정 시 자동으로 할일 생성
2. **마감일**: 배정일 기준 D+1 (영업일)
3. **우선순위**: 
   - 고액 (1억 이상): high
   - 중액 (5천만~1억): medium
   - 소액 (5천만 미만): low

### 5.4 감사 로그 규칙
1. **필수 기록 대상**:
   - 고객 정보 생성/수정/삭제
   - 상담사 배정/변경
   - 상담 상태 변경
   - 금융사 조회 요청/응답
   - 대출 승인/실행

2. **보관 기간**: 최소 1년 (법적 요구사항에 따라 연장)

---

## 6. 예외 처리 및 에러 시나리오

### 6.1 고객 입력 단계
- **불완전한 정보**: 필수 항목 미입력 시 진행 불가 안내
- **인증 실패**: 3회 실패 시 전화 상담 안내
- **매칭 결과 없음**: "조건에 맞는 금융사가 없습니다. 전문 상담을 신청하시겠습니까?"

### 6.2 상담 진행 단계
- **상담사 부재**: 관리자에게 알림, 다른 상담사 재배정
- **금융사 조회 실패**: 재시도 또는 다른 금융사 조회
- **고객 연락 불가**: 문자 발송, 재연락 할일 생성

### 6.3 시스템 오류
- **API 타임아웃**: 재시도 로직 (최대 3회)
- **데이터 저장 실패**: 트랜잭션 롤백, 에러 로그 기록
- **외부 API 장애**: Mock 데이터로 대체 또는 수동 처리 안내

---

## 7. 성과 지표 (KPI)

### 7.1 고객 관련
- **전환율**: 방문자 대비 상담 신청 비율
- **완료율**: 상담 신청 대비 대출 실행 비율
- **평균 처리 시간**: 상담 신청부터 대출 실행까지 소요 시간

### 7.2 상담사 관련
- **상담 건수**: 상담사별 월간 상담 건수
- **승인율**: 상담 건수 대비 승인 건수
- **실행 금액**: 상담사별 월간 실행 금액

### 7.3 금융사 관련
- **조회 건수**: 금융사별 조회 요청 건수
- **승인율**: 금융사별 승인 비율
- **평균 금리**: 금융사별 평균 적용 금리

---

이 플로우차트와 프로세스 설명으로 담보대출 상담 업무를 이해하셨나요? 
추가 질문이나 수정 사항이 있으면 말씀해주세요!
