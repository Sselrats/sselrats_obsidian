# Admin API (`admin.loandoc.com/api/v1`)

## 1. Admin Authentication

### 1.1 Admin Login

```http
POST /auth/login
Content-Type: application/json

{
  "email": "consultant@loandoc.com",
  "password": "password123"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "access_token": "jwt_token_here",
  "refresh_token": "refresh_token_here",
  "expires_in": 86400,
  "consultant": {
    "id": 5,
    "name": "김상담",
    "email": "consultant@loandoc.com",
    "is_super": false
  }
}
```

### 1.2 Refresh Token

```http
POST /auth/refresh
Content-Type: application/json

{
  "refresh_token": "refresh_token_here"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "access_token": "new_jwt_token",
  "expires_in": 86400
}
```

---

## 2. Dashboard

### 2.1 Get Dashboard Stats

```http
GET /dashboard
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "stats": {
    "total_consultations": 150,
    "active_consultations": 35,
    "pending_tasks": 12,
    "new_customers_today": 5,
    "consultations_by_status": {
      "상담대기": 10,
      "상담중": 15,
      "조회중": 5,
      "심사중": 3,
      "승인": 2
    }
  },
  "recent_consultations": [
    {
      "id": 1,
      "customer_name": "홍길동",
      "type": "전화상담",
      "status": "상담중",
      "created_at": "2025-01-02T10:00:00Z"
    }
  ],
  "urgent_tasks": [
    {
      "id": 1,
      "customer_name": "김철수",
      "deadline": "2025-01-02T18:00:00Z",
      "priority": "높음"
    }
  ]
}
```

---

## 3. Consultations Management

### 3.1 List Consultations

```http
GET /consultations?status=상담중&consultant_id=5&limit=20&offset=0
Authorization: Bearer {admin_jwt}
```

**Note**: Super admin sees all consultations. Regular admin sees only their own.

**Response** (200 OK):

```json
{
  "consultations": [
    {
      "id": 1,
      "customer": {
        "id": 123,
        "name": "홍길동",
        "phone": "01012345678"
      },
      "consultant": {
        "id": 5,
        "name": "김상담"
      },
      "property": {
        "id": 1,
        "address_full": "서울특별시 강남구..."
      },
      "type": "전화상담",
      "status": "상담중",
      "institution": {
        "id": 10,
        "name": "현대캐피탈"
      },
      "institution_manager": "김담당",
      "created_at": "2025-01-02T10:00:00Z",
      "updated_at": "2025-01-02T11:00:00Z"
    }
  ],
  "total": 35,
  "limit": 20,
  "offset": 0
}
```

### 3.2 Get Consultation Details

```http
GET /consultations/{consultation_id}
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "consultation": {
    "id": 1,
    "customer": {
      "id": 123,
      "name": "홍길동",
      "phone": "01012345678",
      "email": "user@example.com",
      "details": {
        "income_type": "직장인",
        "annual_income": 50000000,
        "kcb_score": 850
      }
    },
    "property": {
      "id": 1,
      "address_full": "서울특별시 강남구 역삼동 123-45",
      "property_type": "아파트",
      "kb_standard_price": 900000000,
      "existing_mortgages": [
        {
          "creditor": "KB국민은행",
          "remaining_balance": 250000000
        }
      ]
    },
    "type": "전화상담",
    "status": "상담중",
    "consultant_id": 5,
    "institution_id": 10,
    "institution_manager": "김담당",
    "created_at": "2025-01-02T10:00:00Z"
  },
  "memos": [
    {
      "id": 1,
      "memo": "초기 상담 완료. 추가 서류 요청함",
      "created_at": "2025-01-02T11:00:00Z",
      "attachments": [
        {
          "id": 1,
          "file_name": "소득증빙.pdf",
          "file_path": "/uploads/...",
          "file_size": 1024000
        }
      ]
    }
  ],
  "calculation_results": [
    {
      "calculation_date": "2025-01-02T12:00:00Z",
      "eligible_products_count": 12,
      "best_offer": {
        "product_name": "현캐 가계대출",
        "available_amount": 810000000,
        "priority_rate": 4.5
      }
    }
  ],
  "summary": "고객원장내용"
}
```

### 3.3 Update Consultation Status

```http
PATCH /consultations/{consultation_id}
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "status": "조회중",
  "institution_id": 10,
  "institution_manager": "김담당"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "consultation": {
    "id": 1,
    "status": "조회중",
    // ... updated data
  }
}
```

### 3.4 Add Consultation Memo

```http
POST /consultations/{consultation_id}/memos
Authorization: Bearer {admin_jwt}
Content-Type: multipart/form-data

memo: "고객과 통화 완료. 추가 서류 수령 예정"
attachments: [file1.pdf, file2.jpg]
```

**Response** (201 Created):

```json
{
  "success": true,
  "memo": {
    "id": 2,
    "consultation_id": 1,
    "memo": "고객과 통화 완료. 추가 서류 수령 예정",
    "created_at": "2025-01-02T14:00:00Z",
    "attachments": [
      {
        "id": 2,
        "file_name": "file1.pdf",
        "file_path": "/uploads/...",
        "file_size": 2048000
      }
    ]
  }
}
```

---

## 4. Tasks Management

### 4.1 List Tasks

```http
GET /tasks?status=대기&consultant_id=5&limit=20&offset=0
Authorization: Bearer {admin_jwt}
```

**Note**: Super admin sees all tasks. Regular admin sees only their own.

**Response** (200 OK):

```json
{
  "tasks": [
    {
      "id": 1,
      "consultation_id": 1,
      "consultant": {
        "id": 5,
        "name": "김상담"
      },
      "customer": {
        "id": 123,
        "name": "홍길동",
        "phone": "01012345678"
      },
      "title": "서류 확인 필요",
      "deadline": "2025-01-03T18:00:00Z",
      "priority": "높음",
      "status": "대기",
      "created_at": "2025-01-02T10:00:00Z"
    }
  ],
  "total": 12,
  "limit": 20,
  "offset": 0
}
```

### 4.2 Create Task

```http
POST /tasks
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "consultation_id": 1,
  "customer_id": 123,
  "title": "서류 확인 필요",
  "description": "소득증빙서류 확인 후 금융기관 전달",
  "deadline": "2025-01-03T18:00:00Z",
  "priority": "높음"
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "task": {
    "id": 1,
    "consultation_id": 1,
    "consultant_id": 5,
    "customer_id": 123,
    "title": "서류 확인 필요",
    "deadline": "2025-01-03T18:00:00Z",
    "priority": "높음",
    "status": "대기",
    "created_at": "2025-01-02T15:00:00Z"
  }
}
```

### 4.3 Update Task Status

```http
PATCH /tasks/{task_id}
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "status": "완료"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "task": {
    "id": 1,
    "status": "완료",
    "completed_at": "2025-01-02T16:00:00Z"
  }
}
```

---

## 5. Customers Management

### 5.1 List Customers

```http
GET /customers?search=홍길동&limit=20&offset=0
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "customers": [
    {
      "id": 123,
      "name": "홍길동",
      "birth_date": "1990-01-01",
      "phone": "01012345678",
      "email": "user@example.com",
      "login_type": "phone",
      "latest_details": {
        "income_type": "직장인",
        "annual_income": 50000000,
        "kcb_score": 850,
        "nice_score": 900
      },
      "consultations_count": 3,
      "latest_consultation": {
        "id": 1,
        "status": "상담중",
        "created_at": "2025-01-02T10:00:00Z"
      },
      "created_at": "2024-12-01T09:00:00Z"
    }
  ],
  "total": 150,
  "limit": 20,
  "offset": 0
}
```

### 5.2 Get Customer Details

```http
GET /customers/{customer_id}
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "customer": {
    "id": 123,
    "name": "홍길동",
    "birth_date": "1990-01-01",
    "phone": "01012345678",
    "email": "user@example.com",
    "profile_image_url": "https://...",
    "login_type": "phone",
    "created_at": "2024-12-01T09:00:00Z"
  },
  "details_history": [
    {
      "id": 456,
      "income_type": "직장인",
      "annual_income": 50000000,
      "employment_insurance": true,
      "kcb_score": 850,
      "nice_score": 900,
      "owned_properties_count": 1,
      "required_amount": 100000000,
      "created_at": "2025-01-02T10:00:00Z"
    }
  ],
  "properties": [
    {
      "id": 1,
      "address_full": "서울특별시 강남구 역삼동 123-45",
      "property_type": "아파트",
      "kb_standard_price": 900000000,
      "existing_mortgages_total": 250000000
    }
  ],
  "consultations": [
    {
      "id": 1,
      "type": "전화상담",
      "status": "상담중",
      "consultant_name": "김상담",
      "created_at": "2025-01-02T10:00:00Z"
    }
  ]
}
```

---

## 6. Financial Products & Policies

### 6.1 List Financial Institutions

```http
GET /financial-institutions?type=캐피탈&is_active=true
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "institutions": [
    {
      "id": 10,
      "name": "현대캐피탈",
      "type": "캐피탈",
      "is_active": true,
      "products_count": 5
    }
  ],
  "total": 15
}
```

### 6.2 List Financial Products

```http
GET /financial-products?institution_id=10&loan_type=가계&is_active=true
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "products": [
    {
      "id": 100,
      "institution": {
        "id": 10,
        "name": "현대캐피탈",
        "type": "캐피탈"
      },
      "product_name": "가계대출 상품A",
      "loan_type": "가계",
      "priority_type": "선순위",
      "is_active": true,
      "policies": {
        "interest_rate": {
          "id": 1,
          "base_rate": 4.0,
          "rate_adjustment": 0.5,
          "effective_date": "2025-01-01",
          "expired_date": null
        },
        "ltv": {
          "id": 1,
          "ltv_ratio": 70,
          "max_amount": null,
          "effective_date": "2025-01-01",
          "expired_date": null
        },
        "collateral_requirements": {
          "id": 1,
          "property_type": "아파트",
          "min_kb_value": 300000000,
          "min_households": 100,
          "max_building_age": 30
        },
        "credit_requirements": {
          "id": 1,
          "min_nice_score": 700,
          "min_kcb_score": 650,
          "max_overdue_days": 0
        },
        "prepayment_fee": {
          "id": 1,
          "fee_type": "슬라이딩",
          "year_fees": [1.8, 1.6, 1.4]
        }
      }
    }
  ],
  "total": 5
}
```

### 6.3 Get Product Details

```http
GET /financial-products/{product_id}
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "product": {
    "id": 100,
    "institution": {
      "id": 10,
      "name": "현대캐피탈",
      "type": "캐피탈"
    },
    "product_name": "가계대출 상품A",
    "loan_type": "가계",
    "priority_type": "선순위",
    "is_active": true,
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2025-01-01T00:00:00Z"
  },
  "interest_rate_policies": [
    {
      "id": 1,
      "effective_date": "2025-01-01",
      "expired_date": null,
      "priority_type": "선순위",
      "base_rate": 4.0,
      "rate_adjustment": 0.5,
      "special_conditions": {
        "직장인": -0.2,
        "사업자": 0.1
      }
    }
  ],
  "ltv_policies": [
    {
      "id": 1,
      "effective_date": "2025-01-01",
      "expired_date": null,
      "priority_type": "선순위",
      "ltv_ratio": 70,
      "max_amount": null,
      "conditions": {
        "1급지": 70,
        "2급지": 65,
        "3급지": 60
      }
    }
  ],
  "collateral_requirements": [
    {
      "id": 1,
      "effective_date": "2025-01-01",
      "expired_date": null,
      "property_type": "아파트",
      "min_kb_value": 300000000,
      "min_households": 100,
      "max_building_age": 30,
      "floor_restrictions": {
        "1층": "하한가",
        "2층": "일반가"
      },
      "region_restrictions": ["제주도"],
      "special_conditions": "역세권 우대"
    }
  ],
  "credit_requirements": [
    {
      "id": 1,
      "effective_date": "2025-01-01",
      "expired_date": null,
      "min_nice_score": 700,
      "min_kcb_score": 650,
      "max_overdue_days": 0,
      "additional_conditions": {
        "재직기간": "6개월 이상"
      }
    }
  ],
  "prepayment_fee_policies": [
    {
      "id": 1,
      "effective_date": "2025-01-01",
      "expired_date": null,
      "fee_type": "슬라이딩",
      "year_fees": [1.8, 1.6, 1.4],
      "calculation_method": {
        "description": "잔액 기준 계산"
      }
    }
  ],
  "other_fees": [
    {
      "id": 1,
      "fee_name": "중개수수료",
      "fee_rate": 0.5,
      "min_amount": 100000,
      "max_amount": 3000000
    }
  ]
}
```

### 6.4 Create Financial Product

```http
POST /financial-products
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "institution_id": 10,
  "product_name": "가계대출 상품B",
  "loan_type": "가계",
  "priority_type": "선순위",
  "is_active": true
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "product": {
    "id": 101,
    "institution_id": 10,
    "product_name": "가계대출 상품B",
    "loan_type": "가계",
    "priority_type": "선순위",
    "is_active": true,
    "created_at": "2025-01-02T15:00:00Z"
  }
}
```

### 6.5 Update Financial Product

```http
PATCH /financial-products/{product_id}
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "product_name": "가계대출 상품A (개정)",
  "is_active": false
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "product": {
    "id": 100,
    "product_name": "가계대출 상품A (개정)",
    "is_active": false,
    "updated_at": "2025-01-02T15:30:00Z"
  }
}
```

### 6.6 Delete Financial Product

```http
DELETE /financial-products/{product_id}
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "success": true,
  "message": "상품이 삭제되었습니다"
}
```

---

## 7. Product Policies Management

### 7.1 Create Interest Rate Policy

```http
POST /financial-products/{product_id}/interest-rate-policies
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "effective_date": "2025-02-01",
  "expired_date": null,
  "priority_type": "선순위",
  "base_rate": 4.2,
  "rate_adjustment": 0.6,
  "special_conditions": {
    "직장인": -0.3,
    "사업자": 0.2
  }
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "policy": {
    "id": 2,
    "financial_product_id": 100,
    "effective_date": "2025-02-01",
    "expired_date": null,
    "priority_type": "선순위",
    "base_rate": 4.2,
    "rate_adjustment": 0.6,
    "special_conditions": {
      "직장인": -0.3,
      "사업자": 0.2
    },
    "created_at": "2025-01-02T16:00:00Z"
  }
}
```

### 7.2 Update Interest Rate Policy

```http
PUT /interest-rate-policies/{policy_id}
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "base_rate": 4.3,
  "rate_adjustment": 0.5,
  "expired_date": "2025-03-31"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "policy": {
    "id": 2,
    "base_rate": 4.3,
    "rate_adjustment": 0.5,
    "expired_date": "2025-03-31",
    "updated_at": "2025-01-02T16:30:00Z"
  }
}
```

### 7.3 Create LTV Policy

```http
POST /financial-products/{product_id}/ltv-policies
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "effective_date": "2025-02-01",
  "expired_date": null,
  "priority_type": "선순위",
  "ltv_ratio": 75,
  "max_amount": 500000000,
  "conditions": {
    "1급지": 75,
    "2급지": 70,
    "3급지": 65
  }
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "policy": {
    "id": 2,
    "financial_product_id": 100,
    "ltv_ratio": 75,
    "max_amount": 500000000,
    "created_at": "2025-01-02T16:45:00Z"
  }
}
```

### 7.4 Create Collateral Requirements

```http
POST /financial-products/{product_id}/collateral-requirements
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "effective_date": "2025-02-01",
  "expired_date": null,
  "property_type": "아파트",
  "min_kb_value": 400000000,
  "min_households": 150,
  "max_building_age": 25,
  "floor_restrictions": {
    "1층": "하한가",
    "2층": "일반가"
  },
  "region_restrictions": ["제주도", "강원도 일부"],
  "special_conditions": "역세권 500m 이내 우대"
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "requirement": {
    "id": 2,
    "financial_product_id": 100,
    "property_type": "아파트",
    "min_kb_value": 400000000,
    "created_at": "2025-01-02T17:00:00Z"
  }
}
```

### 7.5 Create Credit Requirements

```http
POST /financial-products/{product_id}/credit-requirements
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "effective_date": "2025-02-01",
  "expired_date": null,
  "min_nice_score": 750,
  "min_kcb_score": 700,
  "max_overdue_days": 0,
  "additional_conditions": {
    "재직기간": "1년 이상",
    "4대보험": "필수"
  }
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "requirement": {
    "id": 2,
    "financial_product_id": 100,
    "min_nice_score": 750,
    "min_kcb_score": 700,
    "created_at": "2025-01-02T17:15:00Z"
  }
}
```

### 7.6 Create Prepayment Fee Policy

```http
POST /financial-products/{product_id}/prepayment-fee-policies
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "effective_date": "2025-02-01",
  "expired_date": null,
  "fee_type": "슬라이딩",
  "year_fees": [2.0, 1.8, 1.5],
  "calculation_method": {
    "description": "잔액 기준 연차별 차등",
    "formula": "remaining_balance * year_fees[year]"
  }
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "policy": {
    "id": 2,
    "financial_product_id": 100,
    "fee_type": "슬라이딩",
    "year_fees": [2.0, 1.8, 1.5],
    "created_at": "2025-01-02T17:30:00Z"
  }
}
```

### 7.7 Create Other Fees

```http
POST /financial-products/{product_id}/other-fees
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "effective_date": "2025-02-01",
  "expired_date": null,
  "fee_name": "법무비용",
  "fee_rate": 0.3,
  "min_amount": 150000,
  "max_amount": 2000000
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "fee": {
    "id": 2,
    "financial_product_id": 100,
    "fee_name": "법무비용",
    "fee_rate": 0.3,
    "created_at": "2025-01-02T17:45:00Z"
  }
}
```

---

## 8. Region Grade Policies (급지 정책)

### 8.1 List Region Grade Policies

```http
GET /region-grade-policies?effective_date=2025-01-01&grade=1급지
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "policies": [
    {
      "id": 1,
      "effective_date": "2025-01-01",
      "expired_date": null,
      "region_type": "수도권",
      "detailed_regions": ["서울", "수원", "성남", "고양", "용인"],
      "grade": "1급지",
      "description": "수도권 주요 도시",
      "exclusions": ["의정부 일부", "남양주 외곽"]
    },
    {
      "id": 2,
      "effective_date": "2025-01-01",
      "expired_date": null,
      "region_type": "광역시",
      "detailed_regions": ["부산", "대구", "인천", "광주", "대전", "울산"],
      "grade": "1급지",
      "description": "광역시 전역",
      "exclusions": []
    }
  ],
  "total": 2
}
```

### 8.2 Get Region Grade Policies by Grade

```http
GET /region-grade-policies/by-grade?grade=1급지&active_only=true
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "grade": "1급지",
  "policies": [
    {
      "id": 1,
      "region_type": "수도권",
      "detailed_regions": ["서울", "수원", "성남", "고양", "용인"],
      "effective_date": "2025-01-01",
      "expired_date": null
    },
    {
      "id": 2,
      "region_type": "광역시",
      "detailed_regions": ["부산", "대구", "인천", "광주", "대전", "울산"],
      "effective_date": "2025-01-01",
      "expired_date": null
    }
  ],
  "total_regions_count": 11
}
```

### 8.3 Check Region Grade

```http
POST /region-grade-policies/check
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "sido": "서울특별시",
  "sigungu": "강남구",
  "effective_date": "2025-01-01"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "region_info": {
    "sido": "서울특별시",
    "sigungu": "강남구",
    "grade": "1급지",
    "region_type": "수도권",
    "policy_id": 1,
    "is_excluded": false,
    "effective_date": "2025-01-01"
  }
}
```

### 8.4 Create Region Grade Policy

```http
POST /region-grade-policies
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "effective_date": "2025-02-01",
  "expired_date": null,
  "region_type": "군읍",
  "detailed_regions": ["홍천", "횡성", "영월", "평창", "정선"],
  "grade": "3급지",
  "description": "강원도 군 지역",
  "exclusions": ["평창 올림픽 특구"]
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "policy": {
    "id": 10,
    "effective_date": "2025-02-01",
    "expired_date": null,
    "region_type": "군읍",
    "detailed_regions": ["홍천", "횡성", "영월", "평창", "정선"],
    "grade": "3급지",
    "description": "강원도 군 지역",
    "exclusions": ["평창 올림픽 특구"],
    "created_at": "2025-01-02T18:00:00Z"
  }
}
```

### 8.5 Update Region Grade Policy

```http
PUT /region-grade-policies/{policy_id}
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "detailed_regions": ["홍천", "횡성", "영월", "평창", "정선", "철원"],
  "exclusions": ["평창 올림픽 특구", "철원 신도시"],
  "expired_date": "2025-12-31"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "policy": {
    "id": 10,
    "detailed_regions": ["홍천", "횡성", "영월", "평창", "정선", "철원"],
    "exclusions": ["평창 올림픽 특구", "철원 신도시"],
    "expired_date": "2025-12-31",
    "updated_at": "2025-01-02T18:30:00Z"
  }
}
```

### 8.6 Delete Region Grade Policy

```http
DELETE /region-grade-policies/{policy_id}
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "success": true,
  "message": "급지 정책이 삭제되었습니다"
}
```

### 8.7 List All Grades Summary

```http
GET /region-grade-policies/grades-summary
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "grades": [
    {
      "grade": "1급지",
      "policies_count": 2,
      "total_regions_count": 11,
      "region_types": ["수도권", "광역시"],
      "latest_update": "2025-01-01T00:00:00Z"
    },
    {
      "grade": "2급지",
      "policies_count": 3,
      "total_regions_count": 25,
      "region_types": ["수도권", "광역시", "전국"],
      "latest_update": "2025-01-01T00:00:00Z"
    },
    {
      "grade": "3급지",
      "policies_count": 5,
      "total_regions_count": 45,
      "region_types": ["군읍", "전국"],
      "latest_update": "2025-01-01T00:00:00Z"
    }
  ]
}
```

---

## 9. Consultants Management (Super Admin Only)

### 9.1 List Consultants

```http
GET /consultants?status=active&limit=20&offset=0
Authorization: Bearer {admin_jwt}
```

**Note**: Only accessible by super admin.

**Response** (200 OK):

```json
{
  "consultants": [
    {
      "id": 5,
      "name": "김상담",
      "email": "consultant@loandoc.com",
      "phone": "01011112222",
      "status": "active",
      "register_number": "2024-001",
      "affiliation": "서울지점",
      "subscription": "premium",
      "is_super": false,
      "active_consultations": 12,
      "total_consultations": 150,
      "created_at": "2024-01-01T00:00:00Z"
    }
  ],
  "total": 15,
  "limit": 20,
  "offset": 0
}
```

### 9.2 Create Consultant

```http
POST /consultants
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "name": "이상담",
  "email": "consultant2@loandoc.com",
  "password": "initial_password123",
  "phone": "01022223333",
  "register_number": "2025-001",
  "affiliation": "부산지점",
  "subscription": "standard",
  "is_super": false
}
```

**Response** (201 Created):

```json
{
  "success": true,
  "consultant": {
    "id": 6,
    "name": "이상담",
    "email": "consultant2@loandoc.com",
    "phone": "01022223333",
    "status": "active",
    "created_at": "2025-01-02T19:00:00Z"
  }
}
```

### 9.3 Update Consultant

```http
PUT /consultants/{consultant_id}
Authorization: Bearer {admin_jwt}
Content-Type: application/json

{
  "affiliation": "대구지점",
  "subscription": "premium",
  "status": "active"
}
```

**Response** (200 OK):

```json
{
  "success": true,
  "consultant": {
    "id": 6,
    "affiliation": "대구지점",
    "subscription": "premium",
    "updated_at": "2025-01-02T19:30:00Z"
  }
}
```

---

## 10. System Logs & Audit

### 10.1 Get Audit Logs

```http
GET /audit-logs?table_name=consultations&actor_id=5&limit=50&offset=0
Authorization: Bearer {admin_jwt}
```

**Response** (200 OK):

```json
{
  "logs": [
    {
      "id": 1,
      "table_name": "consultations",
      "record_id": 1,
      "action": "UPDATE",
      "actor_type": "consultant",
      "actor_id": 5,
      "actor_name": "김상담",
      "changed_fields": ["status", "institution_manager"],
      "old_values": {
        "status": "상담대기",
        "institution_manager": null
      },
      "new_values": {
        "status": "조회중",
        "institution_manager": "김담당"
      },
      "ip_address": "1.2.3.4",
      "user_agent": "Mozilla/5.0...",
      "created_at": "2025-01-02T14:30:00Z"
    }
  ],
  "total": 150,
  "limit": 50,
  "offset": 0
}
```

---

